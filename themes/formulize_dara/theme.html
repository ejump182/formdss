<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="<{$icms_langcode}>">
<head>
    <!-- Center block custom positioning -->
    <{* Center blocks display order
        valid values are:  lrc (left right / center) lcr (left center right) clr (center / left right)
    *}>
    <{assign var=theme_top_order value=lrc}>
    <{assign var=theme_bottom_order value=lcr}>

    <!-- Theme name -->
    <{assign var=theme_name value=$xoTheme->folderName}>

    <!-- Title and meta -->
    <title><{if $icms_pagetitle !=''}><{$icms_pagetitle}> : <{/if}><{$icms_sitename}></title>
    <meta http-equiv="content-type" content="text/html; charset=<{$icms_charset}>" />
    <meta name="robots" content="<{$icms_meta_robots}>" />
    <meta name="keywords" content="<{$icms_meta_keywords}>" />
    <meta name="description" content="<{$icms_meta_description}>" />
    <meta name="rating" content="<{$icms_meta_rating}>" />
    <meta name="author" content="<{$icms_meta_author}>" />
    <meta name="copyright" content="<{$icms_meta_copyright}>" />
    <meta name="generator" content="ImpressCMS" />

    <!-- Module Header -->
    <{$icms_module_header}>

    <!-- Favicon -->
    <link rel="shortcut icon" type="image/ico" href="<{xoImgUrl icons/favicon.ico}>" />
    <link rel="icon" type="image/png" href="<{xoImgUrl icons/icon.png}>" />

    <!-- Sheet Css -->
    <link rel="stylesheet" type="text/css" media="all" href="<{$icms_imageurl}><{if isset($icms_rtl) and $icms_rtl}>rtl/<{/if}>style.css" />
    
    <!-- Dara menu -->
    <link rel="stylesheet" type="text/css" media="all" href="<{$icms_imageurl}>menu.css" />
    <script src="<{$icms_imageurl}>menu.js"></script>
    
</head>

<body id="<{$icms_dirname}>" class="<{$icms_langcode}><{if isset($formulize_screen_id) and $formulize_screen_id}> formulize-screen formulize-screen-<{$formulize_screen_id}><{/if}>">
    <{includeq file="$theme_name/session-timeout-warning.html"}>
    <{if $xoBlocks.canvas_left and $xoBlocks.canvas_right}>
    <{assign var=columns_layout value='threecolumns-layout'}>
    <{elseif $xoBlocks.canvas_left}>
    <{assign var=columns_layout value='leftcolumn-layout'}>
    <{elseif $xoBlocks.canvas_right}>
    <{assign var=columns_layout value='rightcolumn-layout'}>
    <{/if}>
    <div id="xo-canvas"<{if $columns_layout}> class="<{$columns_layout}>"<{/if}>>
        <!-- Header -->
        <div id="xo-header">
            <div id="xo-headerlogo"><a href="<{xoAppUrl /}>" title=""><img src="<{$icms_imageurl}>img/logo.png" alt="<{$icms_sitename}>" /></a></div>
            <div id="xo-headerbanner">
                
                <h1>DARA</h1>
                    <p>Daniels Academic Resource Administration</p>
            </div>
                <!-- Header menu (optional) -->
                <div id="xo-globalnav">
                    
                    <ul>
                        
                        <{php}>
                            global $xoopsUser;
                            if($xoopsUser) {
                        <{/php}>
                            
                        <li class="dropdown">
                            <a href="javascript:void(0)" class="dropbtn" onclick="myFunction('myDropdown')">Modules</a>
                            <div class="dropdown-content" id="myDropdown" class="dropdown-menu">
                                <{php}>
                                    // menu reading code borrowed from mymenu.php in Formulize block
                                    // DARA is application 1
                                    $application_handler = xoops_getmodulehandler('applications', 'formulize');
                                    foreach($application_handler->getMenuLinksForApp(1) as $menulink) {
                            			$suburl = XOOPS_URL."/modules/formulize/index.php?".$menulink->getVar("screen");
                                        $url = $menulink->getVar("url");
                                        $target = "";
                                        if(strlen($url) > 0){
                                            $target = strstr($url, XOOPS_URL) ? "" : " target='_blank' ";
                                            $pos = strpos($url,"://");
                                            if($pos === false){
                                                $url = "http://".$url;
                                            }
                                            $suburl = $url;
                                        }
                                        print "<a $target href='$suburl'>".$menulink->getVar("text")."</a>\n";
                                    }	
                                <{/php}>
                            </div>
                        </li>
                         
                        <{if isset($formulize_screen_id) and $formulize_screen_id}>
                            <{php}>
                                $displayButtons = array("changeColsButton", "selectAllButton", "clearSelectButton", "cloneButton", "deleteButton", "exportButton", "calcButton", "notifButton", "saveViewButton", "deleteViewButton", "resetViewButton");
                                foreach($displayButtons as $buttonName) {
                                    if($GLOBALS['formulize_buttonCodeArray'][$buttonName]) {
                                        $buttonCode .= $GLOBALS['formulize_buttonCodeArray'][$buttonName]."<br />\n";
                                    }
                                }
                                if($buttonCode) {
                            <{/php}>
                            <li class="dropdown">
                                <a href="javascript:void(0)" class="dropbtn" onclick="myFunction('myDropdown2')">Module Actions</a>
                                <div class="dropdown-content" id="myDropdown2" class="dropdown-menu">
                                        <{php}>print $buttonCode<{/php}> 
                                </div>
                            </li>
                            <{php}> } <{/php}>
                        <{/if}>
                            
                        <{if $xoops_isadmin}>
                        <li class="dropdown">
                            <a href="javascript:void(0)" class="dropbtn" onclick="myFunction('myDropdown3')">Admin Modules</a>
                            <div class="dropdown-content" id="myDropdown3" class="dropdown-menu">
                                <a href="<{$icms_url}>/modules/profile/admin/user.php" title="User Management">User Management</a>
                                <a href="<{$icms_url}>/modules/formulize/index.php?sid=60" title="Year Management">Year Management</a>
                                <a  href='<{$icms_url}>/modules/formulize/index.php?sid=53'>Semester Dates</a>
                                <a  href='<{$icms_url}>/modules/formulize/index.php?sid=66'>Weighting Overrides</a>
                                <a  href='<{$icms_url}>/modules/formulize/index.php?fid=7'>Course Prefixes</a>
                                <a  href='<{$icms_url}>/modules/formulize/index.php?sid=4'>Ranks/Titles/Stipends</a>
                                <{if isset($formulize_screen_id) and $formulize_screen_id}>
                                <a href="<{$icms_url}>/modules/formulize/admin/ui.php?page=screen&sid=<{$formulize_screen_id}>" title="edit screen">Edit This Screen</a>
                                <{/if}>
                            </div>
                        </li>
                        <{/if}>    
                            
                        <li><a href="<{$icms_url}>/edituser.php" title="Edit Account">Edit Account</a></li>
                        <!-- <li><a href="<{$icms_url}>/viewpmsg.php" title="Inbox">Inbox</a></li> -->
                        <li><a href="<{$icms_url}>/user.php?op=logout" title="Logout">Logout</a></li>

                        <{php}>
                            } // end of if xoopsUser
                        <{/php}>
                        
                    </ul>
                    
                </div>
            
        </div>

        <!-- Content -->
        <div id="xo-canvas-content">
            <div id="xo-canvas-columns">
                <!-- Left column -->
                <{if isset($icms_rtl) and $icms_rtl}>
                    <{if $xoBlocks.canvas_right}>
                    <{includeq file="$theme_name/blockszone.html" blocks=$xoBlocks.canvas_right
                        zoneClass='xo-canvas-column' zoneId='xo-canvas-rightcolumn'
                    }>
                    <{/if}>
                <{else}>
                    <{if $xoBlocks.canvas_left}>
                        <{includeq file="$theme_name/blockszone.html" blocks=$xoBlocks.canvas_left
                            zoneClass='xo-canvas-column' zoneId='xo-canvas-leftcolumn'
                        }>
                    <{/if}>
                <{/if}>
                <!-- Center column / page -->
                <div id="xo-page">
                    <!-- Top blocks -->
                    <{if $xoBlocks.page_topleft or $xoBlocks.page_topcenter or $xoBlocks.page_topright}>
                        <div class="xo-blockszone xo-<{$theme_top_order}>pageblocks" id="xo-page-topblocks">
                            <{includeq file="$theme_name/centerblocks.html" topbottom=top lcr=$theme_top_order|substr:0:1}>
                            <{includeq file="$theme_name/centerblocks.html" topbottom=top lcr=$theme_top_order|substr:1:1}>
                            <{includeq file="$theme_name/centerblocks.html" topbottom=top lcr=$theme_top_order|substr:2:1}>
                        </div>
                    <{/if}>
                    <!-- Module content -->
                    <{if $icms_contents}>
                        <div id="xo-content"><{$icms_contents}></div>
                    <{/if}>
                    <!-- Bottom blocks -->
                    <{if $xoBlocks.page_bottomleft or $xoBlocks.page_bottomcenter or $xoBlocks.page_bottomright}>
                        <div class="xo-blockszone xo-<{$theme_bottom_order}>pageblocks" id="xo-page-bottomblocks">
                            <{includeq file="$theme_name/centerblocks.html" topbottom=bottom lcr=$theme_bottom_order|substr:0:1}>
                            <{includeq file="$theme_name/centerblocks.html" topbottom=bottom lcr=$theme_bottom_order|substr:1:1}>
                            <{includeq file="$theme_name/centerblocks.html" topbottom=bottom lcr=$theme_bottom_order|substr:2:1}>
                        </div>
                    <{/if}>
                </div>
                <!-- Right column -->
                <{if isset($icms_rtl) and $icms_rtl}>
                    <{if $xoBlocks.canvas_left}>
                        <{includeq file="$theme_name/blockszone.html" blocks=$xoBlocks.canvas_left
                            zoneClass='xo-canvas-column' zoneId='xo-canvas-leftcolumn'
                        }>
                    <{/if}>
                <{else}>
                    <{if $xoBlocks.canvas_right}>
                        <{includeq file="$theme_name/blockszone.html" blocks=$xoBlocks.canvas_right
                            zoneClass='xo-canvas-column' zoneId='xo-canvas-rightcolumn'
                        }>
                    <{/if}>
                <{/if}>
                </div>
            </div>
            <div id="footer-padding">&nbsp;</div>
        </div>
    </div>

    <div id="xo-footer">
        <{$icms_footer}>
        <{ if $masquerade_username }>
            <div id="formulize-masquerade-block">
                Masquerading as <b><{$masquerade_username}></b>
                <form method="post" action="<{$smarty.const.XOOPS_URL}>/modules/formulize/">
                    <input type="hidden" name="revert" value="1" />
                    <input type="hidden" name="op" value="masquerade" />
                    <input type="hidden" name="masquerade_end" value="1" />
                    <input type="submit" name="confirm_submit" value="Revert" />
                </form>
            </div>
            <div style="clear:both;"></div>
        <{ /if }>
    </div>
    
    <{php}>
        
        $yearData = getData('',21);
        $activeYears = "\nvar activeYears = {";
        foreach($yearData as $thisYear) {
            $year = display($thisYear, 'master_year_list_year');
            $status = display($thisYear, 'master_year_list_status');
            if($status == 'Active') {
                $activeYears .= "'".$year."':1,";
            }
        }
        $activeYears.="};\n";
        
        // for TAship form, remove tutorial taught by instructor option
        // disable form if the taship is in a locked year
        if(isset($_GET['sid']) AND $_GET['sid']==38) {
    <{/php}>
       
        <script type='text/javascript'>
            jQuery("input[type=radio][id$='_108-2']").remove();
            jQuery("label[for$='_108-2']").remove();
            
            <{php}> /*print $activeYears;
            
            var disable = true;
            for (var year in activeYears) {
                var courseText = jQuery('.formulize-input-taships_full_course_title').text();
                if (!courseText || courseText.indexOf(year) > -1) {
                    disable = false;
                    break;
                }
            }
            if (disable) {
                jQuery("input[type='button']").each(function() {
                    jQuery(this).remove();
                });
            }*/
            <{/php}>

        </script>
        
    <{php}>
        }
        
        // remove locked years from RO form on new entries
        // remove submission features from RO form on existing entries if the year is locked
        if(isset($_GET['fid']) AND $_GET['fid']==3) {
            <{/php}>
            <script type='text/javascript'>
            <{php}>print $activeYears;<{/php}>
            jQuery("#de_3_new_14 option").each(function() {
                if(typeof activeYears[jQuery(this).text()] == 'undefined') {
                    jQuery(this).remove();
                }
            });
            if(jQuery("input[name^='de_3_'][name$='_206']").val()==2) {
                jQuery("input[type='button']").each(function() {
                    jQuery(this).remove();
                });
                jQuery("input[name^='addsubentries']").parents('p').remove();
            }
            </script>
            <{php}>
        } 
    <{/php}>    
    
</body>
</html>
